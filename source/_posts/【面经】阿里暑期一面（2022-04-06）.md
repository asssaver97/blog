---
title: 【面经】阿里暑期一面（2022/04/06）
date: 2022-04-06 21:25:32
categories: 面经
---
一、堆和栈哪个更快？

1. 栈是由编译器自动分配内存，所以更快；堆是程序员动态分配内存，相对更慢
2. 栈使用的是一级缓存， 他们通常都是被调用时处于存储空间中，调用完毕立即释放；堆则是存放在二级缓存中，生命周期由虚拟机的垃圾回收算法来决定（并不是一旦成为孤儿对象就能被回收）。所以调用这些对象的速度要相对来得低一些。

二、什么是一级缓存、什么是二级缓存？

* 一级缓存一般内置在内核旁边，是与CPU结合最为紧密的高速缓存，可以有效的提高CPU的运行效率。一级缓存越大，CPU的运行效率越高，但受到成本限制，一级缓存的容量都很小。
* L2（就是二级）缓存是在独立芯片（有可能是在一个扩展卡上），它的访问速度能比大的主存要快得多。通常一个二级缓存的大小为1024Kb（1Mb）。

三、 栈的具体调用过程、怎么压入弹出的？

[C语言下程序的堆栈调用（详细，图示）](https://blog.csdn.net/prokgtfy9n18/article/details/70231640)

[EBP 和 ESP 详解](https://blog.csdn.net/yu97271486/article/details/80425089)

四、free的时候怎么确定要释放多少内存？

先是pop（弹出堆栈）edi,esi,ebx这三个寄存器，然后将ebp给esp，也就是说把刚刚上面开辟的空间收回，然后经过ret跳回至刚刚在main函数处调用函数那儿（现场保护）。（见上面第一个链接）

五、C++14 string实现？如果是不够就申请空间的话

[第14篇:C++的string-两手抓的内存分配](https://zhuanlan.zhihu.com/p/187499607)

六、http用的是tcp还是udp？

tcp。追求可靠。

七、tcp接收方收到乱序的包时，对这个包怎么处理？

* 在缓存区里，不会丢弃，直到有序了以后直接排序。
* 主机每次发送数据时，TCP就给每个数据包分配一个序列号并且在一个特定的时间内等待接收主机 对分配的这个序列号进行确认，如果发送主机在一个特定时间内没有收到接收主机的确认，则发送 主机会重传此数据包。接收主机利用序列号对接收的数据进行确认，以便检测对方发送的数据是否 有丢失或者乱序等，接收主机一旦收到已经顺序化的数据，它就将这些数据按正确的顺序重组成数 据流并传递到高层进行处理。
* 具体步骤如下:

1. 为了保证数据包的可靠传递，发送方必须把已发送的数据包保留在缓冲区;
2. 并为每个已发送的数据包启动一个超时定时器;
3. 如在定时器超时之前收到了对方发来的应答信息(可能是对本包的应答，也可以是对本包后 续包的应答)，则释放该数据包占用的缓冲区;
4. 否则，重传该数据包，直到收到应答或重传次数超过规定的最大次数为止。
5. 接收方收到数据包后，先进行CRC校验，如果正确则把数据交给上层协议，然后给发送方发 送一个累计应答包，表明该数据已收到，如果接收方正好也有数据要发给发送方，应答包也可方在 数据包中捎带过去。

八、怎么从tcp中解出http？

[如何从TCP中提取HTTP报文](https://blog.csdn.net/u010088405/article/details/52396813)

[从一个HTTP请求来读懂HTTP、TCP协议](https://cloud.tencent.com/developer/news/717465)

九、http1.0和http1.1区别？1.1的header里多了什么？

* http/1.0 : 
    1. 默认不支持长连接，需要设置keep-alive参数指定
    2. 强缓存expired、协商缓存last-modified\if-modified-since 有一定的缺陷
* http 1.1 :
    1. 默认长连接(keep-alive)，http请求可以复用Tcp连接，但是同一时间只能对应一个http请求(http请 求在一个Tcp中是串行的)
    2. 增加了强缓存cache-control、协商缓存etag\if-none-match 是对http/1 缓存的优化


十、有多个服务器时，怎么确保是正确的服务器接收到了消息？

十一、muduo用的是什么单例模式？

十二、epoll水平触发和边缘触发？

十三、怎么根据有几个核来确定设置几个线程？怎么确定cpu有多少核？

* 线程数量和哪些因素有关:CPU，IO、并行、并发
* 如果是CPU密集型应用，则线程池大小设置为:CPU数目+1 
* 如果是IO密集型应用，则线程池大小设置为:2*CPU数目+1 
* 最佳线程数目 = (线程等待时间与线程CPU时间之比 + 1)* CPU数目

```
# 总核数 = 物理CPU个数 X 每颗物理CPU的核数 
# 总逻辑CPU数 = 物理CPU个数 X 每颗物理CPU的核数 X 超线程数

# 查看物理CPU个数
cat /proc/cpuinfo| grep "physical id"| sort| uniq| wc -l

# 查看每个物理CPU中core的个数(即核数)
cat /proc/cpuinfo| grep "cpu cores"| uniq

# 查看逻辑CPU的个数
cat /proc/cpuinfo| grep "processor"| wc -l
```

十四、linux在哪里查看日志？有几种方法进入插入模式？怎么查找？怎么跳到第一行？怎么跳到最后一行？怎么复制一行？

* /var/log
* 插入模式 
    * 按「i」切换进入插入模式「insert mode」，按"i"进入插入模式后是从光标当前位置开始输入文件；
    * 按「a」进入插入模式后，是从目前光标所在位置的下一个位置开始输入文字； 
    * 按「o」进入插入模式后，是插入新的一行，从行首开始输入文字。

```
--递归查找目录下含有该字符串的所有文件
grep -rn "data_chushou_pay_info"  /home/hadoop/nisj/automationDemand/
 
--查找当前目录下后缀名过滤的文件
grep -Rn "data_chushou_pay_info" *.py
 
--当前目录及设定子目录下的符合条件的文件
grep -Rn "data_chushou_pay_info" /home/hadoop/nisj/automationDemand/ *.py
 
--结合find命令过滤目录及文件名后缀
find /home/hadoop/nisj/automationDemand/ -type f -name '*.py'|xargs grep -n 'data_chushou_pay_info'
```

* 跳到文本的最后一行：按“G”,即“shift+g”
* 跳到第一行的第一个字符：先按两次“g”
* 复制一行数据数据： 把光标放到要复制的行行首，然后按两下yy字母键； 然后把光标放到要复制到的地方去，按键盘的p字母键

十五、开放题：怎么在http服务端设计一个用户注册系统？

十六、算法题：LRU
