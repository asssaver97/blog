---
title: 【LeetCode刷题笔记】剑指Offer16.数值的整次方数
date: 2022-01-25 20:54:56
tags: 算法
categories: 刷题笔记
mathjax: true
---
题目
---
[**剑指Offer 16. 数值的整次方数**](https://leetcode-cn.com/problems/shu-zhi-de-zheng-shu-ci-fang-lcof/)

实现`pow(x, n)`，即计算`x`的`n`次幂函数。不得使用库函数，同时不需要考虑大数问题。

示例 1：
```
输入：x = 2.00000, n = 10
输出：1024.00000
```
示例 2：
```
输入：x = 2.10000, n = 3
输出：9.26100
```
示例 3：
```
输入：x = 2.00000, n = -2
输出：0.25000
解释：2-2 = 1/22 = 1/4 = 0.25
```

提示：
* `-100.0 < x < 100.0`
* `-231 <= n <= 231-1`
* `-104 <= xn <= 104`
<!--more-->

题解
---
**快速幂法！！！**
快速幂法有两种解析角度：
**二进制角度**
对于任意十进制数n，有对应二进制$b_m...b_2b_1b_0$...，则：
* $n=1b_0+2b_1+4b_2+...+2^mb_m$;
* $x^n=x^{(1b_0+2b_1+4b_2+...+2^mb_m)}$;

因此，对于计算$x^n$，我们可以将其转换为两个子问题：
* 计算$x^1$，$x^2$，$x^4$，...，$x^{2^m}$的值；
* 计算二进制数$b_0$，$b_1$，$b_2$，...，$b_m$的值。

具体地，步骤如下：
* 首先，初始化`res=1`；
* 接着，判断当前位二进制$b_k$是否为一，即`if (n&1)`，若为1，则res乘上$x^{2^k}$，即`res *= x`；
* 然后，将n右移一位（除以2），即`n >> 1`，并将`x *= x`。
循环2、3步，最后输出res。
<!--more-->

**二分法角度**
$x^n=x^{n/2}+x^{n/2}=(x^2)^{n/2}$，如果想要保持整数幂，则分奇偶两种情况，我们假设向下取整为`//`：
* 若n为奇数，则$x^n=x*(x^2)^{n//2}$；
* 若n为偶数，则$x^n=(x^2)^{n//2}$。
具体步骤同上。

代码
---
```cpp
class Solution {
public:
    double myPow(double x, int n) {
        long int m = n;
        if (n < 0) {
            x = 1/x;
            m = -m; // 这里要注意溢出
        }
        double res = 1;
        while (m > 0) {
            if (m & 1) res *= x;
            x *= x;
            m /= 2;
        }
        return res;
    }
};
```
